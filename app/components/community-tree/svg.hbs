  <svg 
    class="community-tree" 
    width={{this.svg.width}} height={{this.svg.height}}
    {{on-key "ArrowRight" (fn this.selectPerson "forward")}}
    {{on-key "ArrowLeft" (fn this.selectPerson "backward")}}
    {{did-insert @calculateSizes}}
    {{did-update @calculateSizes}}
    >
    <defs>
      <radialGradient id="community-tree-inner-gradient" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
        <stop 
          offset="{{mult 0.9 this.gradient1817}}%" 
          style="stop-color:rgb(255,255,255); stop-opacity:1" />
        <stop 
        offset="{{this.gradient1817}}%"
          style="stop-color:rgb(255,255,255); stop-opacity:0.5" />
        <stop 
        offset="{{mult 1.09 this.gradient1817}}%" 
         style="stop-color:rgb(255,255,255); stop-opacity:0" />
      </radialGradient>
      <radialGradient id="community-tree-outer-gradient" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
        <stop 
          offset="{{mult 0.95 this.gradient1832}}%" 
          style="stop-color:rgb(255,255,255); stop-opacity:0" />
        <stop 
        offset="{{this.gradient1832}}%"
          style="stop-color:rgb(255,255,255); stop-opacity:0.5" />
        <stop 
        offset="{{mult 1.04 this.gradient1832}}%" 
         style="stop-color:rgb(255,255,255); stop-opacity:1" />
      </radialGradient>
      <CommunityTree::AgeScaleBarGradient />
      {{#each @data as |person|}}
        <CommunityTree::PersonGradient @person={{person}} />
      {{/each}}
    </defs>
    <g 
      transform="translate({{add this.svg.margins.left this.svg.circleRadius}},{{add this.svg.margins.top this.svg.circleRadius}})">
      {{#each @data as |person i|}}
      <CommunityTree::Person 
        @person={{person}}
        @i={{i}} 
        @dataLength={{this.dataLength}}
        @yearScale={{this.yearScale}}
        @colorScale={{this.colorScale}}
        @minYear={{this.minYear}}
      />
      {{/each}}
    </g>
    <g transform="translate({{mult this.svg.width 0.1}},{{sub this.svg.height 100}})">
        <CommunityTree::AgeScaleBar @ageScale={{this.ageScale}} @width={{this.svg.ageScaleBarWidth}}/>
    </g>
      <rect x={{this.svg.margins.left}} y={{this.svg.margins.top}}
        width={{sub this.svg.width (add this.svg.margins.left this.svg.margins.right) }}
        height={{sub this.svg.height (add this.svg.margins.top this.svg.margins.bottom) }}
        fill="none"
        stroke="none"
        stroke-width="3"
        />
      <ellipse cx="0" cy="0" 
        class="pointer-events-none"
        rx={{this.svg.circleRadius}} 
        ry={{this.svg.circleRadius}} 
        fill="url(#community-tree-inner-gradient)" 
        transform="translate({{add this.svg.margins.left this.svg.circleRadius}},{{add this.svg.margins.top this.svg.circleRadius}})"/>
      <ellipse cx="0" cy="0" 
        class="pointer-events-none"
        rx={{this.svg.circleRadius}} 
        ry={{this.svg.circleRadius}} 
        fill="url(#community-tree-outer-gradient)" 
        transform="translate({{add this.svg.margins.left this.svg.circleRadius}},{{add this.svg.margins.top this.svg.circleRadius}})"/>
      <g transform="translate({{add this.svg.margins.left this.svg.circleRadius}},
      {{add this.svg.margins.top this.svg.circleRadius}})">
        <CommunityTree::YearScale
          @yearScale={{this.yearScale}} 
          @width={{this.svg.circleRadius}}
          />
      </g>
  </svg>
