  <svg 
    class="community-tree" 
    width={{this.svg.width}} height={{this.svg.height}}
    {{on-key "ArrowRight" (fn this.selectPerson "forward")}}
    {{on-key "ArrowLeft" (fn this.selectPerson "backward")}}
    {{did-insert @calculateSizes}}
    {{did-update @calculateSizes}}
    >
    <defs>
      <filter id="white-glow" filterUnits="userSpaceOnUse"
        x="-50%" y="-50%" width="200%" height="200%">
        <feGaussianBlur in="SourceGraphic" stdDeviation="2" result="blur2"/>
        <feGaussianBlur in="SourceGraphic" stdDeviation="5" result="blur5"/>
        <feGaussianBlur in="SourceGraphic" stdDeviation="10" result="blur10"/>
        <feGaussianBlur in="SourceGraphic" stdDeviation="15" result="blur15"/>
        <feGaussianBlur in="SourceGraphic" stdDeviation="20" result="blur20"/>
        <feMerge result="blur-merged">
          <feMergeNode in="blur2"/>
          <feMergeNode in="blur5"/>
          <feMergeNode in="blur10"/>
          <feMergeNode in="blur15"/>
          <feMergeNode in="blur20"/>
        </feMerge>
        <feColorMatrix result="white-blur" in="blur-merged" type="matrix"
               values="0 0 0 1 1
                       0 0 0 1 1
                       0 0 0 1 1
                       1 1 1 1 0" />
        <feMerge>
          <feMergeNode in="white-blur"/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>

      <radialGradient id="community-tree-inner-gradient" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
        <stop 
          offset="{{mult 0.9 this.gradient1817}}%" 
          style="stop-color:rgb(248, 250, 252); stop-opacity:1" />
        <stop 
        offset="{{this.gradient1817}}%"
          style="stop-color:rgb(248, 250, 252); stop-opacity:0.5" />
        <stop 
        offset="{{mult 1.09 this.gradient1817}}%" 
         style="stop-color:rgb(248, 250, 252); stop-opacity:0" />
      </radialGradient>
      <radialGradient id="community-tree-outer-gradient" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
        <stop 
          offset="{{mult 0.95 this.gradient1832}}%" 
          style="stop-color:rgb(248, 250, 252); stop-opacity:0" />
        <stop 
        offset="{{this.gradient1832}}%"
          style="stop-color:rgb(248, 250, 252); stop-opacity:0.5" />
        <stop 
        offset="{{mult 1.04 this.gradient1832}}%" 
         style="stop-color:rgb(248, 250, 252); stop-opacity:1" />
      </radialGradient>
      <CommunityTree::AgeScaleBarGradient />
      {{#each this.data.people as |person|}}
        <CommunityTree::PersonGradient @person={{person}} />
      {{/each}}
    </defs>
    <Frond />
    <g 
      id="community-tree-circle"
      style="opacity: 0;"
      transform={{this.svg.circleTransform}}>
      {{#each this.data.sortedData as |person i|}}
      <CommunityTree::Person 
        @person={{person}}
        @i={{i}} 
        @dataLength={{this.dataLength}}
        @yearScale={{this.yearScale}}
        @colorScale={{this.colorScale}}
        @minYear={{this.minYear}}
      />
      {{/each}}
      <ellipse cx="0" cy="0" 
        class="pointer-events-none"
        rx={{this.svg.circleRadius}} 
        ry={{this.svg.circleRadius}} 
        fill="url(#community-tree-inner-gradient)" 
      />
      <ellipse cx="0" cy="0" 
        class="pointer-events-none"
        rx={{this.svg.circleRadius}} 
        ry={{this.svg.circleRadius}} 
        fill="url(#community-tree-outer-gradient)" 
      />
      <g>
        <CommunityTree::YearScale
          @yearScale={{this.yearScale}} 
          @width={{this.svg.circleRadius}}
          />
      </g>
    </g>
    <CommunityTree::AgeScaleBar @ageScale={{this.ageScale}} @width={{this.svg.ageScaleBarWidth}}/>
    <rect x={{this.svg.margins.left}} width={{sub this.svg.width this.svg.margins.left this.svg.margins.right}} 
      y={{this.svg.margins.top}} height={{sub this.svg.height this.svg.margins.top this.svg.margins.bottom}} fill="none" stroke="none" />
  </svg>
